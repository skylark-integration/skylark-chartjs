{"version":3,"sources":["core/core.animations.js"],"names":["define","__module__0","__module__1","exports","module","helpers","__isValidToReturn","obj","Array","isArray","attr","__isEmptyObject","_set","animation","duration","easing","onProgress","noop","onComplete","animations","request","addAnimation","chart","lazy","i","ilen","this","startTime","Date","now","animating","length","push","requestAnimationFrame","cancelAnimation","index","findIndex","splice","me","requestAnimFrame","call","window","startDigest","advance","numSteps","nextStep","Math","floor","currentStep","min","callback","render","onAnimationProgress","onAnimationComplete"],"mappings":";;;;;;;AAAAA,QACI,kBACA,oBACD,SAAUC,EAAaC,GACtB,aACA,IAAIC,KACAC,GAAWD,YAEXE,EAAUH,EAwFd,SAASI,EAAkBC,GACvB,MAAqB,iBAAPA,GAAmBC,MAAMC,QAAQF,KAPnD,SAAyBA,GACrB,IAAIG,EACJ,IAAKA,KAAQH,EACT,OAAO,EACX,OAAO,EAGiDI,CAAgBJ,GAE5E,OA5FeN,EAENW,KAAK,UACVC,WACIC,SAAU,IACVC,OAAQ,eACRC,WAAYX,EAAQY,KACpBC,WAAYb,EAAQY,QAG5Bb,EAAOD,SACHgB,cACAC,QAAS,KACTC,aAAc,SAAUC,EAAOT,EAAWC,EAAUS,GAChD,IACIC,EAAGC,EADHN,EAAaO,KAAKP,WAQtB,IANAN,EAAUS,MAAQA,EAClBT,EAAUc,UAAYC,KAAKC,MAC3BhB,EAAUC,SAAWA,EAChBS,IACDD,EAAMQ,WAAY,GAEjBN,EAAI,EAAGC,EAAON,EAAWY,OAAQP,EAAIC,IAAQD,EAC9C,GAAIL,EAAWK,GAAGF,QAAUA,EAExB,YADAH,EAAWK,GAAKX,GAIxBM,EAAWa,KAAKnB,GACU,IAAtBM,EAAWY,QACXL,KAAKO,yBAGbC,gBAAiB,SAAUZ,GACvB,IAAIa,EAAQ9B,EAAQ+B,UAAUV,KAAKP,WAAY,SAAUN,GACrD,OAAOA,EAAUS,QAAUA,KAEhB,IAAXa,IACAT,KAAKP,WAAWkB,OAAOF,EAAO,GAC9Bb,EAAMQ,WAAY,IAG1BG,sBAAuB,WACnB,IAAIK,EAAKZ,KACU,OAAfY,EAAGlB,UACHkB,EAAGlB,QAAUf,EAAQkC,iBAAiBC,KAAKC,OAAQ,WAC/CH,EAAGlB,QAAU,KACbkB,EAAGI,kBAIfA,YAAa,WACAhB,KACNiB,UADMjB,KAEFP,WAAWY,OAAS,GAFlBL,KAGFO,yBAGXU,QAAS,WAIL,IAHA,IACI9B,EAAWS,EAAOsB,EAAUC,EAD5B1B,EAAaO,KAAKP,WAElBK,EAAI,EACDA,EAAIL,EAAWY,QAElBT,GADAT,EAAYM,EAAWK,IACLF,MAClBsB,EAAW/B,EAAU+B,SACrBC,EAAWC,KAAKC,OAAOnB,KAAKC,MAAQhB,EAAUc,WAAad,EAAUC,SAAW8B,GAAY,EAC5F/B,EAAUmC,YAAcF,KAAKG,IAAIJ,EAAUD,GAC3CvC,EAAQ6C,SAASrC,EAAUsC,QACvB7B,EACAT,GACDS,GACHjB,EAAQ6C,SAASrC,EAAUuC,qBAAsBvC,GAAYS,GACzDT,EAAUmC,aAAeJ,GACzBvC,EAAQ6C,SAASrC,EAAUwC,qBAAsBxC,GAAYS,GAC7DA,EAAMQ,WAAY,EAClBX,EAAWkB,OAAOb,EAAG,MAEnBA,IAcdlB,EAAkBF,EAAOD,SAClBC,EAAOD,QACTG,EAAkBH,GAChBA,OADN","file":"../../core/core.animations.js","sourcesContent":["define([\n    './core.defaults',\n    '../helpers/index'\n], function (__module__0, __module__1) {\n    'use strict';\n    var exports = {};\n    var module = { exports: {} };\n    var defaults = __module__0;\n    var helpers = __module__1;\n    defaults._set('global', {\n        animation: {\n            duration: 1000,\n            easing: 'easeOutQuart',\n            onProgress: helpers.noop,\n            onComplete: helpers.noop\n        }\n    });\n    module.exports = {\n        animations: [],\n        request: null,\n        addAnimation: function (chart, animation, duration, lazy) {\n            var animations = this.animations;\n            var i, ilen;\n            animation.chart = chart;\n            animation.startTime = Date.now();\n            animation.duration = duration;\n            if (!lazy) {\n                chart.animating = true;\n            }\n            for (i = 0, ilen = animations.length; i < ilen; ++i) {\n                if (animations[i].chart === chart) {\n                    animations[i] = animation;\n                    return;\n                }\n            }\n            animations.push(animation);\n            if (animations.length === 1) {\n                this.requestAnimationFrame();\n            }\n        },\n        cancelAnimation: function (chart) {\n            var index = helpers.findIndex(this.animations, function (animation) {\n                return animation.chart === chart;\n            });\n            if (index !== -1) {\n                this.animations.splice(index, 1);\n                chart.animating = false;\n            }\n        },\n        requestAnimationFrame: function () {\n            var me = this;\n            if (me.request === null) {\n                me.request = helpers.requestAnimFrame.call(window, function () {\n                    me.request = null;\n                    me.startDigest();\n                });\n            }\n        },\n        startDigest: function () {\n            var me = this;\n            me.advance();\n            if (me.animations.length > 0) {\n                me.requestAnimationFrame();\n            }\n        },\n        advance: function () {\n            var animations = this.animations;\n            var animation, chart, numSteps, nextStep;\n            var i = 0;\n            while (i < animations.length) {\n                animation = animations[i];\n                chart = animation.chart;\n                numSteps = animation.numSteps;\n                nextStep = Math.floor((Date.now() - animation.startTime) / animation.duration * numSteps) + 1;\n                animation.currentStep = Math.min(nextStep, numSteps);\n                helpers.callback(animation.render, [\n                    chart,\n                    animation\n                ], chart);\n                helpers.callback(animation.onAnimationProgress, [animation], chart);\n                if (animation.currentStep >= numSteps) {\n                    helpers.callback(animation.onAnimationComplete, [animation], chart);\n                    chart.animating = false;\n                    animations.splice(i, 1);\n                } else {\n                    ++i;\n                }\n            }\n        }\n    };\n    function __isEmptyObject(obj) {\n        var attr;\n        for (attr in obj)\n            return !1;\n        return !0;\n    }\n    function __isValidToReturn(obj) {\n        return typeof obj != 'object' || Array.isArray(obj) || !__isEmptyObject(obj);\n    }\n    if (__isValidToReturn(module.exports))\n        return module.exports;\n    else if (__isValidToReturn(exports))\n        return exports;\n});"]}