/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../helpers/index","../core/core.scale","../core/core.ticks"],function(t,a,i,o){"use strict";var e={},n={exports:{}},r=t,l=a,s=i,m=o,h=l.valueOrDefault;var c={position:"left",ticks:{callback:m.formatters.logarithmic}};function u(t,a){return l.isFinite(t)&&t>=0?t:a}function f(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var a;for(a in t)return!1;return!0}(t)}return n.exports=s.extend({determineDataLimits:function(){var t=this,a=t.options,i=t.chart,o=i.data.datasets,e=t.isHorizontal();function n(a){return e?a.xAxisID===t.id:a.yAxisID===t.id}t.min=null,t.max=null,t.minNotZero=null;var r=a.stacked;if(void 0===r&&l.each(o,function(t,a){if(!r){var o=i.getDatasetMeta(a);i.isDatasetVisible(a)&&n(o)&&void 0!==o.stack&&(r=!0)}}),a.stacked||r){var s={};l.each(o,function(o,e){var r=i.getDatasetMeta(e),m=[r.type,void 0===a.stacked&&void 0===r.stack?e:"",r.stack].join(".");i.isDatasetVisible(e)&&n(r)&&(void 0===s[m]&&(s[m]=[]),l.each(o.data,function(a,i){var o=s[m],e=+t.getRightValue(a);isNaN(e)||r.data[i].hidden||e<0||(o[i]=o[i]||0,o[i]+=e)}))}),l.each(s,function(a){if(a.length>0){var i=l.min(a),o=l.max(a);t.min=null===t.min?i:Math.min(t.min,i),t.max=null===t.max?o:Math.max(t.max,o)}})}else l.each(o,function(a,o){var e=i.getDatasetMeta(o);i.isDatasetVisible(o)&&n(e)&&l.each(a.data,function(a,i){var o=+t.getRightValue(a);isNaN(o)||e.data[i].hidden||o<0||(null===t.min?t.min=o:o<t.min&&(t.min=o),null===t.max?t.max=o:o>t.max&&(t.max=o),0!==o&&(null===t.minNotZero||o<t.minNotZero)&&(t.minNotZero=o))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,a=t.options.ticks;t.min=u(a.min,t.min),t.max=u(a.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(l.log10(t.min))-1),t.max=Math.pow(10,Math.floor(l.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(l.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(l.log10(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(l.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,a=t.options.ticks,i=!t.isHorizontal(),o={min:u(a.min),max:u(a.max)},e=t.ticks=function(t,a){var i,o,e=[],n=h(t.min,Math.pow(10,Math.floor(l.log10(a.min)))),r=Math.floor(l.log10(a.max)),s=Math.ceil(a.max/Math.pow(10,r));0===n?(i=Math.floor(l.log10(a.minNotZero)),o=Math.floor(a.minNotZero/Math.pow(10,i)),e.push(n),n=o*Math.pow(10,i)):(i=Math.floor(l.log10(n)),o=Math.floor(n/Math.pow(10,i)));var m=i<0?Math.pow(10,Math.abs(i)):1;do{e.push(n),10==++o&&(o=1,m=++i>=0?1:m),n=Math.round(o*Math.pow(10,i)*m)/m}while(i<r||i===r&&o<s);var c=h(t.max,n);return e.push(c),e}(o,t);t.max=l.max(e),t.min=l.min(e),a.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&e.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),s.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,a){return+this.getRightValue(this.chart.data.datasets[a].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var a=Math.floor(l.log10(t));return Math.floor(t/Math.pow(10,a))*Math.pow(10,a)},getPixelForValue:function(t){var a,i,o,e,n,s=this,m=s.options.ticks,c=m.reverse,u=l.log10,f=s._getFirstTickValue(s.minNotZero),d=0;return t=+s.getRightValue(t),c?(o=s.end,e=s.start,n=-1):(o=s.start,e=s.end,n=1),s.isHorizontal()?(a=s.width,i=c?s.right:s.left):(a=s.height,n*=-1,i=c?s.top:s.bottom),t!==o&&(0===o&&(a-=d=h(m.fontSize,r.global.defaultFontSize),o=f),0!==t&&(d+=a/(u(e)-u(o))*(u(t)-u(o))),i+=n*d),i},getValueForPixel:function(t){var a,i,o,e,n=this,s=n.options.ticks,m=s.reverse,c=l.log10,u=n._getFirstTickValue(n.minNotZero);if(m?(i=n.end,o=n.start):(i=n.start,o=n.end),n.isHorizontal()?(a=n.width,e=m?n.right-t:t-n.left):(a=n.height,e=m?t-n.top:n.bottom-t),e!==i){if(0===i){var f=h(s.fontSize,r.global.defaultFontSize);e-=f,a-=f,i=u}e*=c(o)-c(i),e/=a,e=Math.pow(10,c(i)+e)}return e}}),n.exports._defaults=c,f(n.exports)?n.exports:f(e)?e:void 0});
//# sourceMappingURL=../sourcemaps/scales/scale.logarithmic.js.map
