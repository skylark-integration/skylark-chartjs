/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../helpers/index","../core/core.scale","../core/core.ticks"],function(t,a,i,o){"use strict";var exports={},module={exports:{}},e=t,n=a,r=i,l=o,s=n.valueOrDefault;var m={position:"left",ticks:{callback:l.formatters.logarithmic}};function h(t,a){return n.isFinite(t)&&t>=0?t:a}function c(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var a;for(a in t)return!1;return!0}(t)}return module.exports=r.extend({determineDataLimits:function(){var t=this,a=t.options,i=t.chart,o=i.data.datasets,e=t.isHorizontal();function r(a){return e?a.xAxisID===t.id:a.yAxisID===t.id}t.min=null,t.max=null,t.minNotZero=null;var l=a.stacked;if(void 0===l&&n.each(o,function(t,a){if(!l){var o=i.getDatasetMeta(a);i.isDatasetVisible(a)&&r(o)&&void 0!==o.stack&&(l=!0)}}),a.stacked||l){var s={};n.each(o,function(o,e){var l=i.getDatasetMeta(e),m=[l.type,void 0===a.stacked&&void 0===l.stack?e:"",l.stack].join(".");i.isDatasetVisible(e)&&r(l)&&(void 0===s[m]&&(s[m]=[]),n.each(o.data,function(a,i){var o=s[m],e=+t.getRightValue(a);isNaN(e)||l.data[i].hidden||e<0||(o[i]=o[i]||0,o[i]+=e)}))}),n.each(s,function(a){if(a.length>0){var i=n.min(a),o=n.max(a);t.min=null===t.min?i:Math.min(t.min,i),t.max=null===t.max?o:Math.max(t.max,o)}})}else n.each(o,function(a,o){var e=i.getDatasetMeta(o);i.isDatasetVisible(o)&&r(e)&&n.each(a.data,function(a,i){var o=+t.getRightValue(a);isNaN(o)||e.data[i].hidden||o<0||(null===t.min?t.min=o:o<t.min&&(t.min=o),null===t.max?t.max=o:o>t.max&&(t.max=o),0!==o&&(null===t.minNotZero||o<t.minNotZero)&&(t.minNotZero=o))})});this.handleTickRangeOptions()},handleTickRangeOptions:function(){var t=this,a=t.options.ticks;t.min=h(a.min,t.min),t.max=h(a.max,t.max),t.min===t.max&&(0!==t.min&&null!==t.min?(t.min=Math.pow(10,Math.floor(n.log10(t.min))-1),t.max=Math.pow(10,Math.floor(n.log10(t.max))+1)):(t.min=1,t.max=10)),null===t.min&&(t.min=Math.pow(10,Math.floor(n.log10(t.max))-1)),null===t.max&&(t.max=0!==t.min?Math.pow(10,Math.floor(n.log10(t.min))+1):10),null===t.minNotZero&&(t.min>0?t.minNotZero=t.min:t.max<1?t.minNotZero=Math.pow(10,Math.floor(n.log10(t.max))):t.minNotZero=1)},buildTicks:function(){var t=this,a=t.options.ticks,i=!t.isHorizontal(),o={min:h(a.min),max:h(a.max)},e=t.ticks=function(t,a){var i,o,e=[],r=s(t.min,Math.pow(10,Math.floor(n.log10(a.min)))),l=Math.floor(n.log10(a.max)),m=Math.ceil(a.max/Math.pow(10,l));0===r?(i=Math.floor(n.log10(a.minNotZero)),o=Math.floor(a.minNotZero/Math.pow(10,i)),e.push(r),r=o*Math.pow(10,i)):(i=Math.floor(n.log10(r)),o=Math.floor(r/Math.pow(10,i)));var h=i<0?Math.pow(10,Math.abs(i)):1;do{e.push(r),10==++o&&(o=1,h=++i>=0?1:h),r=Math.round(o*Math.pow(10,i)*h)/h}while(i<l||i===l&&o<m);var c=s(t.max,r);return e.push(c),e}(o,t);t.max=n.max(e),t.min=n.min(e),a.reverse?(i=!i,t.start=t.max,t.end=t.min):(t.start=t.min,t.end=t.max),i&&e.reverse()},convertTicksToLabels:function(){this.tickValues=this.ticks.slice(),r.prototype.convertTicksToLabels.call(this)},getLabelForIndex:function(t,a){return+this.getRightValue(this.chart.data.datasets[a].data[t])},getPixelForTick:function(t){return this.getPixelForValue(this.tickValues[t])},_getFirstTickValue:function(t){var a=Math.floor(n.log10(t));return Math.floor(t/Math.pow(10,a))*Math.pow(10,a)},getPixelForValue:function(t){var a,i,o,r,l,m=this,h=m.options.ticks,c=h.reverse,u=n.log10,f=m._getFirstTickValue(m.minNotZero),d=0;return t=+m.getRightValue(t),c?(o=m.end,r=m.start,l=-1):(o=m.start,r=m.end,l=1),m.isHorizontal()?(a=m.width,i=c?m.right:m.left):(a=m.height,l*=-1,i=c?m.top:m.bottom),t!==o&&(0===o&&(a-=d=s(h.fontSize,e.global.defaultFontSize),o=f),0!==t&&(d+=a/(u(r)-u(o))*(u(t)-u(o))),i+=l*d),i},getValueForPixel:function(t){var a,i,o,r,l=this,m=l.options.ticks,h=m.reverse,c=n.log10,u=l._getFirstTickValue(l.minNotZero);if(h?(i=l.end,o=l.start):(i=l.start,o=l.end),l.isHorizontal()?(a=l.width,r=h?l.right-t:t-l.left):(a=l.height,r=h?t-l.top:l.bottom-t),r!==i){if(0===i){var f=s(m.fontSize,e.global.defaultFontSize);r-=f,a-=f,i=u}r*=c(o)-c(i),r/=a,r=Math.pow(10,c(i)+r)}return r}}),module.exports._defaults=m,c(module.exports)?module.exports:c(exports)?exports:void 0});
//# sourceMappingURL=../sourcemaps/scales/scale.logarithmic.js.map
