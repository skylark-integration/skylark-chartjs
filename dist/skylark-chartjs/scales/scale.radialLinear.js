/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../helpers/index","./scale.linearbase","../core/core.ticks"],function(t,e,i,n){"use strict";var a={},r={exports:{}},o=t,s=e,l=i,d=n,h=s.valueOrDefault,c=s.valueAtIndexOrDefault,f=s.options.resolve,g={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:d.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function p(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function u(t){var e=t.ticks;return e.display&&t.display?h(e.fontSize,o.global.defaultFontSize)+2*e.backdropPaddingY:0}function b(t,e,i,n,a){return t===n||t===a?{start:e-i/2,end:e+i/2}:t<n||t>a?{start:e-i,end:e}:{start:e,end:e+i}}function x(t){return 0===t||180===t?"center":t<180?"left":"right"}function v(t,e,i,n){var a,r,o=i.y+n/2;if(s.isArray(e))for(a=0,r=e.length;a<r;++a)t.fillText(e[a],i.x,o),o+=n;else t.fillText(e,i.x,o)}function m(t,e,i){90===t||270===t?i.y-=e.h/2:(t>270||t<90)&&(i.y-=e.h)}function y(t){return s.isNumber(t)?t:0}function P(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var e;for(e in t)return!1;return!0}(t)}return r.exports=l.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=u(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;s.each(e.data.datasets,function(a,r){if(e.isDatasetVisible(r)){var o=e.getDatasetMeta(r);s.each(a.data,function(e,a){var r=+t.getRightValue(e);isNaN(r)||o.data[a].hidden||(i=Math.min(r,i),n=Math.max(r,n))})}}),t.min=i===Number.POSITIVE_INFINITY?0:i,t.max=n===Number.NEGATIVE_INFINITY?0:n,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/u(this.options))},convertTicksToLabels:function(){var t=this;l.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,a=s.options._parseFont(t.options.pointLabels),r={l:0,r:t.width,t:0,b:t.height-t.paddingTop},o={};t.ctx.font=a.string,t._pointLabelSizes=[];var l,d,h,c=p(t);for(e=0;e<c;e++){n=t.getPointPosition(e,t.drawingArea+5),l=t.ctx,d=a.lineHeight,h=t.pointLabels[e]||"",i=s.isArray(h)?{w:s.longestText(l,l.font,h),h:h.length*d}:{w:l.measureText(h).width,h:d},t._pointLabelSizes[e]=i;var f=t.getIndexAngle(e),g=s.toDegrees(f)%360,u=b(g,n.x,i.w,0,180),x=b(g,n.y,i.h,90,270);u.start<r.l&&(r.l=u.start,o.l=f),u.end>r.r&&(r.r=u.end,o.r=f),x.start<r.t&&(r.t=x.start,o.t=f),x.end>r.b&&(r.b=x.end,o.b=f)}t.setReductions(t.drawingArea,r,o)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=this,a=e.l/Math.sin(i.l),r=Math.max(e.r-n.width,0)/Math.sin(i.r),o=-e.t/Math.cos(i.t),s=-Math.max(e.b-(n.height-n.paddingTop),0)/Math.cos(i.b);a=y(a),r=y(r),o=y(o),s=y(s),n.drawingArea=Math.min(Math.floor(t-(a+r)/2),Math.floor(t-(o+s)/2)),n.setCenterPoint(a,r,o,s)},setCenterPoint:function(t,e,i,n){var a=this,r=a.width-e-a.drawingArea,o=t+a.drawingArea,s=i+a.drawingArea,l=a.height-a.paddingTop-n-a.drawingArea;a.xCenter=Math.floor((o+r)/2+a.left),a.yCenter=Math.floor((s+l)/2+a.top+a.paddingTop)},getIndexAngle:function(t){return t*(2*Math.PI/p(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0)},draw:function(){var t=this,e=t.options,i=e.gridLines,n=e.ticks;if(e.display){var a=t.ctx,r=this.getIndexAngle(0),l=s.options._parseFont(n);(e.angleLines.display||e.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,a=i.gridLines,r=i.pointLabels,l=h(n.lineWidth,a.lineWidth),d=h(n.color,a.color),g=u(i);e.save(),e.lineWidth=l,e.strokeStyle=d,e.setLineDash&&(e.setLineDash(f([n.borderDash,a.borderDash,[]])),e.lineDashOffset=f([n.borderDashOffset,a.borderDashOffset,0]));var b=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),y=s.options._parseFont(r);e.font=y.string,e.textBaseline="middle";for(var P=p(t)-1;P>=0;P--){if(n.display&&l&&d){var L=t.getPointPosition(P,b);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(L.x,L.y),e.stroke()}if(r.display){var T=0===P?g/2:0,k=t.getPointPosition(P,b+T+5),A=c(r.fontColor,P,o.global.defaultFontColor);e.fillStyle=A;var I=t.getIndexAngle(P),D=s.toDegrees(I);e.textAlign=x(D),m(D,t._pointLabelSizes[P],k),v(e,t.pointLabels[P]||"",k,y.lineHeight)}}e.restore()}(t),s.each(t.ticks,function(e,s){if(s>0||n.reverse){var d=t.getDistanceFromCenterForValue(t.ticksAsNumbers[s]);if(i.display&&0!==s&&function(t,e,i,n){var a,r=t.ctx,o=e.circular,s=p(t),l=c(e.color,n-1),d=c(e.lineWidth,n-1);if((o||s)&&l&&d){if(r.save(),r.strokeStyle=l,r.lineWidth=d,r.setLineDash&&(r.setLineDash(e.borderDash||[]),r.lineDashOffset=e.borderDashOffset||0),r.beginPath(),o)r.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{a=t.getPointPosition(0,i),r.moveTo(a.x,a.y);for(var h=1;h<s;h++)a=t.getPointPosition(h,i),r.lineTo(a.x,a.y)}r.closePath(),r.stroke(),r.restore()}}(t,i,d,s),n.display){var f=h(n.fontColor,o.global.defaultFontColor);if(a.font=l.string,a.save(),a.translate(t.xCenter,t.yCenter),a.rotate(r),n.showLabelBackdrop){var g=a.measureText(e).width;a.fillStyle=n.backdropColor,a.fillRect(-g/2-n.backdropPaddingX,-d-l.size/2-n.backdropPaddingY,g+2*n.backdropPaddingX,l.size+2*n.backdropPaddingY)}a.textAlign="center",a.textBaseline="middle",a.fillStyle=f,a.fillText(e,0,-d),a.restore()}}})}}}),r.exports._defaults=g,P(r.exports)?r.exports:P(a)?a:void 0});
//# sourceMappingURL=../sourcemaps/scales/scale.radialLinear.js.map
