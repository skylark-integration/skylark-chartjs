/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../helpers/index","./scale.linearbase","../core/core.ticks"],function(t,e,i,n){"use strict";var exports={},module={exports:{}},a=t,r=e,o=i,s=n,l=r.valueOrDefault,d=r.valueAtIndexOrDefault,h=r.options.resolve,c={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,color:"rgba(0, 0, 0, 0.1)",lineWidth:1,borderDash:[],borderDashOffset:0},gridLines:{circular:!1},ticks:{showLabelBackdrop:!0,backdropColor:"rgba(255,255,255,0.75)",backdropPaddingY:2,backdropPaddingX:2,callback:s.formatters.linear},pointLabels:{display:!0,fontSize:10,callback:function(t){return t}}};function f(t){var e=t.options;return e.angleLines.display||e.pointLabels.display?t.chart.data.labels.length:0}function g(t){var e=t.ticks;return e.display&&t.display?l(e.fontSize,a.global.defaultFontSize)+2*e.backdropPaddingY:0}function p(t,e,i,n,a){return t===n||t===a?{start:e-i/2,end:e+i/2}:t<n||t>a?{start:e-i,end:e}:{start:e,end:e+i}}function u(t){return 0===t||180===t?"center":t<180?"left":"right"}function b(t,e,i,n){var a,o,s=i.y+n/2;if(r.isArray(e))for(a=0,o=e.length;a<o;++a)t.fillText(e[a],i.x,s),s+=n;else t.fillText(e,i.x,s)}function x(t,e,i){90===t||270===t?i.y-=e.h/2:(t>270||t<90)&&(i.y-=e.h)}function v(t){return r.isNumber(t)?t:0}function m(t){return"object"!=typeof t||Array.isArray(t)||!function(t){var e;for(e in t)return!1;return!0}(t)}return module.exports=o.extend({setDimensions:function(){var t=this;t.width=t.maxWidth,t.height=t.maxHeight,t.paddingTop=g(t.options)/2,t.xCenter=Math.floor(t.width/2),t.yCenter=Math.floor((t.height-t.paddingTop)/2),t.drawingArea=Math.min(t.height-t.paddingTop,t.width)/2},determineDataLimits:function(){var t=this,e=t.chart,i=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;r.each(e.data.datasets,function(a,o){if(e.isDatasetVisible(o)){var s=e.getDatasetMeta(o);r.each(a.data,function(e,a){var r=+t.getRightValue(e);isNaN(r)||s.data[a].hidden||(i=Math.min(r,i),n=Math.max(r,n))})}}),t.min=i===Number.POSITIVE_INFINITY?0:i,t.max=n===Number.NEGATIVE_INFINITY?0:n,t.handleTickRangeOptions()},_computeTickLimit:function(){return Math.ceil(this.drawingArea/g(this.options))},convertTicksToLabels:function(){var t=this;o.prototype.convertTicksToLabels.call(t),t.pointLabels=t.chart.data.labels.map(t.options.pointLabels.callback,t)},getLabelForIndex:function(t,e){return+this.getRightValue(this.chart.data.datasets[e].data[t])},fit:function(){var t=this.options;t.display&&t.pointLabels.display?function(t){var e,i,n,a=r.options._parseFont(t.options.pointLabels),o={l:0,r:t.width,t:0,b:t.height-t.paddingTop},s={};t.ctx.font=a.string,t._pointLabelSizes=[];var l,d,h,c=f(t);for(e=0;e<c;e++){n=t.getPointPosition(e,t.drawingArea+5),l=t.ctx,d=a.lineHeight,h=t.pointLabels[e]||"",i=r.isArray(h)?{w:r.longestText(l,l.font,h),h:h.length*d}:{w:l.measureText(h).width,h:d},t._pointLabelSizes[e]=i;var g=t.getIndexAngle(e),u=r.toDegrees(g)%360,b=p(u,n.x,i.w,0,180),x=p(u,n.y,i.h,90,270);b.start<o.l&&(o.l=b.start,s.l=g),b.end>o.r&&(o.r=b.end,s.r=g),x.start<o.t&&(o.t=x.start,s.t=g),x.end>o.b&&(o.b=x.end,s.b=g)}t.setReductions(t.drawingArea,o,s)}(this):this.setCenterPoint(0,0,0,0)},setReductions:function(t,e,i){var n=this,a=e.l/Math.sin(i.l),r=Math.max(e.r-n.width,0)/Math.sin(i.r),o=-e.t/Math.cos(i.t),s=-Math.max(e.b-(n.height-n.paddingTop),0)/Math.cos(i.b);a=v(a),r=v(r),o=v(o),s=v(s),n.drawingArea=Math.min(Math.floor(t-(a+r)/2),Math.floor(t-(o+s)/2)),n.setCenterPoint(a,r,o,s)},setCenterPoint:function(t,e,i,n){var a=this,r=a.width-e-a.drawingArea,o=t+a.drawingArea,s=i+a.drawingArea,l=a.height-a.paddingTop-n-a.drawingArea;a.xCenter=Math.floor((o+r)/2+a.left),a.yCenter=Math.floor((s+l)/2+a.top+a.paddingTop)},getIndexAngle:function(t){return t*(2*Math.PI/f(this))+(this.chart.options&&this.chart.options.startAngle?this.chart.options.startAngle:0)*Math.PI*2/360},getDistanceFromCenterForValue:function(t){var e=this;if(null===t)return 0;var i=e.drawingArea/(e.max-e.min);return e.options.ticks.reverse?(e.max-t)*i:(t-e.min)*i},getPointPosition:function(t,e){var i=this.getIndexAngle(t)-Math.PI/2;return{x:Math.cos(i)*e+this.xCenter,y:Math.sin(i)*e+this.yCenter}},getPointPositionForValue:function(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))},getBasePosition:function(){var t=this.min,e=this.max;return this.getPointPositionForValue(0,this.beginAtZero?0:t<0&&e<0?e:t>0&&e>0?t:0)},draw:function(){var t=this,e=t.options,i=e.gridLines,n=e.ticks;if(e.display){var o=t.ctx,s=this.getIndexAngle(0),c=r.options._parseFont(n);(e.angleLines.display||e.pointLabels.display)&&function(t){var e=t.ctx,i=t.options,n=i.angleLines,o=i.gridLines,s=i.pointLabels,c=l(n.lineWidth,o.lineWidth),p=l(n.color,o.color),v=g(i);e.save(),e.lineWidth=c,e.strokeStyle=p,e.setLineDash&&(e.setLineDash(h([n.borderDash,o.borderDash,[]])),e.lineDashOffset=h([n.borderDashOffset,o.borderDashOffset,0]));var m=t.getDistanceFromCenterForValue(i.ticks.reverse?t.min:t.max),y=r.options._parseFont(s);e.font=y.string,e.textBaseline="middle";for(var P=f(t)-1;P>=0;P--){if(n.display&&c&&p){var L=t.getPointPosition(P,m);e.beginPath(),e.moveTo(t.xCenter,t.yCenter),e.lineTo(L.x,L.y),e.stroke()}if(s.display){var T=0===P?v/2:0,k=t.getPointPosition(P,m+T+5),A=d(s.fontColor,P,a.global.defaultFontColor);e.fillStyle=A;var I=t.getIndexAngle(P),D=r.toDegrees(I);e.textAlign=u(D),x(D,t._pointLabelSizes[P],k),b(e,t.pointLabels[P]||"",k,y.lineHeight)}}e.restore()}(t),r.each(t.ticks,function(e,r){if(r>0||n.reverse){var h=t.getDistanceFromCenterForValue(t.ticksAsNumbers[r]);if(i.display&&0!==r&&function(t,e,i,n){var a,r=t.ctx,o=e.circular,s=f(t),l=d(e.color,n-1),h=d(e.lineWidth,n-1);if((o||s)&&l&&h){if(r.save(),r.strokeStyle=l,r.lineWidth=h,r.setLineDash&&(r.setLineDash(e.borderDash||[]),r.lineDashOffset=e.borderDashOffset||0),r.beginPath(),o)r.arc(t.xCenter,t.yCenter,i,0,2*Math.PI);else{a=t.getPointPosition(0,i),r.moveTo(a.x,a.y);for(var c=1;c<s;c++)a=t.getPointPosition(c,i),r.lineTo(a.x,a.y)}r.closePath(),r.stroke(),r.restore()}}(t,i,h,r),n.display){var g=l(n.fontColor,a.global.defaultFontColor);if(o.font=c.string,o.save(),o.translate(t.xCenter,t.yCenter),o.rotate(s),n.showLabelBackdrop){var p=o.measureText(e).width;o.fillStyle=n.backdropColor,o.fillRect(-p/2-n.backdropPaddingX,-h-c.size/2-n.backdropPaddingY,p+2*n.backdropPaddingX,c.size+2*n.backdropPaddingY)}o.textAlign="center",o.textBaseline="middle",o.fillStyle=g,o.fillText(e,0,-h),o.restore()}}})}}}),module.exports._defaults=c,m(module.exports)?module.exports:m(exports)?exports:void 0});
//# sourceMappingURL=../sourcemaps/scales/scale.radialLinear.js.map
