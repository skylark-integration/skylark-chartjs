/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.datasetController","../core/core.defaults","../elements/index","../helpers/index"],function(e,t,o,r){"use strict";var exports={},module={exports:{}},i=e,n=t,a=o,s=r,d=s.valueOrDefault,l=s.options.resolve,u=s.canvas._isPointInArea;function p(e,t){return d(e.showLine,t.showLines)}function c(e){return"object"!=typeof e||Array.isArray(e)||!function(e){var t;for(t in e)return!1;return!0}(e)}return n._set("line",{showLines:!0,spanGaps:!1,hover:{mode:"label"},scales:{xAxes:[{type:"category",id:"x-axis-0"}],yAxes:[{type:"linear",id:"y-axis-0"}]}}),module.exports=i.extend({datasetElementType:a.Line,dataElementType:a.Point,update:function(e){var t,o,r=this,i=r.getMeta(),n=i.dataset,a=i.data||[],s=r.getScaleForId(i.yAxisID),d=r.getDataset(),l=p(d,r.chart.options);for(l&&(void 0!==d.tension&&void 0===d.lineTension&&(d.lineTension=d.tension),n._scale=s,n._datasetIndex=r.index,n._children=a,n._model=r._resolveLineOptions(n),n.pivot()),t=0,o=a.length;t<o;++t)r.updateElement(a[t],t,e);for(l&&0!==n._model.tension&&r.updateBezierControlPoints(),t=0,o=a.length;t<o;++t)a[t].pivot()},updateElement:function(e,t,o){var r,i,n=this,a=n.getMeta(),s=e.custom||{},l=n.getDataset(),u=n.index,p=l.data[t],c=n.getScaleForId(a.yAxisID),h=n.getScaleForId(a.xAxisID),v=a.dataset._model,x=n._resolvePointOptions(e,t);r=h.getPixelForValue("object"==typeof p?p:NaN,t,u),i=o?c.getBasePixel():n.calculatePointY(p,t,u),e._xScale=h,e._yScale=c,e._options=x,e._datasetIndex=u,e._index=t,e._model={x:r,y:i,skip:s.skip||isNaN(r)||isNaN(i),radius:x.radius,pointStyle:x.pointStyle,rotation:x.rotation,backgroundColor:x.backgroundColor,borderColor:x.borderColor,borderWidth:x.borderWidth,tension:d(s.tension,v?v.tension:0),steppedLine:!!v&&v.steppedLine,hitRadius:x.hitRadius}},_resolvePointOptions:function(e,t){var o,r,i,n=this.chart,a=n.data.datasets[this.index],s=e.custom||{},d=n.options.elements.point,u={},p={chart:n,dataIndex:t,dataset:a,datasetIndex:this.index},c={backgroundColor:"pointBackgroundColor",borderColor:"pointBorderColor",borderWidth:"pointBorderWidth",hitRadius:"pointHitRadius",hoverBackgroundColor:"pointHoverBackgroundColor",hoverBorderColor:"pointHoverBorderColor",hoverBorderWidth:"pointHoverBorderWidth",hoverRadius:"pointHoverRadius",pointStyle:"pointStyle",radius:"pointRadius",rotation:"pointRotation"},h=Object.keys(c);for(o=0,r=h.length;o<r;++o)u[i=h[o]]=l([s[i],a[c[i]],a[i],d[i]],p,t);return u},_resolveLineOptions:function(e){var t,o,r,i=this.chart,n=i.data.datasets[this.index],a=e.custom||{},s=i.options,u=s.elements.line,p={},c=["backgroundColor","borderWidth","borderColor","borderCapStyle","borderDash","borderDashOffset","borderJoinStyle","fill","cubicInterpolationMode"];for(t=0,o=c.length;t<o;++t)p[r=c[t]]=l([a[r],n[r],u[r]]);return p.spanGaps=d(n.spanGaps,s.spanGaps),p.tension=d(n.lineTension,u.tension),p.steppedLine=l([a.steppedLine,n.steppedLine,u.stepped]),p},calculatePointY:function(e,t,o){var r,i,n,a=this.chart,s=this.getMeta(),d=this.getScaleForId(s.yAxisID),l=0,u=0;if(d.options.stacked){for(r=0;r<o;r++)if(i=a.data.datasets[r],"line"===(n=a.getDatasetMeta(r)).type&&n.yAxisID===d.id&&a.isDatasetVisible(r)){var p=Number(d.getRightValue(i.data[t]));p<0?u+=p||0:l+=p||0}var c=Number(d.getRightValue(e));return c<0?d.getPixelForValue(u+c):d.getPixelForValue(l+c)}return d.getPixelForValue(e)},updateBezierControlPoints:function(){var e,t,o,r,i=this.chart,n=this.getMeta(),a=n.dataset._model,d=i.chartArea,l=n.data||[];function p(e,t,o){return Math.max(Math.min(e,o),t)}if(a.spanGaps&&(l=l.filter(function(e){return!e._model.skip})),"monotone"===a.cubicInterpolationMode)s.splineCurveMonotone(l);else for(e=0,t=l.length;e<t;++e)o=l[e]._model,r=s.splineCurve(s.previousItem(l,e)._model,o,s.nextItem(l,e)._model,a.tension),o.controlPointPreviousX=r.previous.x,o.controlPointPreviousY=r.previous.y,o.controlPointNextX=r.next.x,o.controlPointNextY=r.next.y;if(i.options.elements.line.capBezierPoints)for(e=0,t=l.length;e<t;++e)o=l[e]._model,u(o,d)&&(e>0&&u(l[e-1]._model,d)&&(o.controlPointPreviousX=p(o.controlPointPreviousX,d.left,d.right),o.controlPointPreviousY=p(o.controlPointPreviousY,d.top,d.bottom)),e<l.length-1&&u(l[e+1]._model,d)&&(o.controlPointNextX=p(o.controlPointNextX,d.left,d.right),o.controlPointNextY=p(o.controlPointNextY,d.top,d.bottom)))},draw:function(){var e,t=this.chart,o=this.getMeta(),r=o.data||[],i=t.chartArea,n=r.length,a=0;for(p(this.getDataset(),t.options)&&(e=(o.dataset._model.borderWidth||0)/2,s.canvas.clipArea(t.ctx,{left:i.left,right:i.right,top:i.top-e,bottom:i.bottom+e}),o.dataset.draw(),s.canvas.unclipArea(t.ctx));a<n;++a)r[a].draw(i)},setHoverStyle:function(e){var t=e._model,o=e._options,r=s.getHoverColor;e.$previousStyle={backgroundColor:t.backgroundColor,borderColor:t.borderColor,borderWidth:t.borderWidth,radius:t.radius},t.backgroundColor=d(o.hoverBackgroundColor,r(o.backgroundColor)),t.borderColor=d(o.hoverBorderColor,r(o.borderColor)),t.borderWidth=d(o.hoverBorderWidth,o.borderWidth),t.radius=d(o.hoverRadius,o.radius)}}),c(module.exports)?module.exports:c(exports)?exports:void 0});
//# sourceMappingURL=../sourcemaps/controllers/controller.line.js.map
