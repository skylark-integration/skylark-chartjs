/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylark-integration/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../elements/index","../helpers/index"],function(e,t,r){"use strict";var exports={},module={exports:{}},n=e,i=t,l=r;n._set("global",{plugins:{filler:{propagate:!0}}});var a={dataset:function(e){var t=e.fill,r=e.chart,n=r.getDatasetMeta(t),i=n&&r.isDatasetVisible(t)&&n.dataset._children||[],l=i.length||0;return l?function(e,t){return t<l&&i[t]._view||null}:null},boundary:function(e){var t=e.boundary,r=t?t.x:null,n=t?t.y:null;return function(e){return{x:null===r?e.x:r,y:null===n?e.y:n}}}};function o(e,t,r){var n,i=e._model||{},l=i.fill;if(void 0===l&&(l=!!i.backgroundColor),!1===l||null===l)return!1;if(!0===l)return"origin";if(n=parseFloat(l,10),isFinite(n)&&Math.floor(n)===n)return"-"!==l[0]&&"+"!==l[0]||(n=t+n),!(n===t||n<0||n>=r)&&n;switch(l){case"bottom":return"start";case"top":return"end";case"zero":return"origin";case"origin":case"start":case"end":return l;default:return!1}}function s(e){var t,r=e.el._model||{},n=e.el._scale||{},i=e.fill,a=null;if(isFinite(i))return null;if("start"===i?a=void 0===r.scaleBottom?n.bottom:r.scaleBottom:"end"===i?a=void 0===r.scaleTop?n.top:r.scaleTop:void 0!==r.scaleZero?a=r.scaleZero:n.getBasePosition?a=n.getBasePosition():n.getBasePixel&&(a=n.getBasePixel()),void 0!==a&&null!==a){if(void 0!==a.x&&void 0!==a.y)return a;if(l.isFinite(a))return{x:(t=n.isHorizontal())?a:null,y:t?null:a}}return null}function u(e,t,r){var n,i=e[t].fill,l=[t];if(!r)return i;for(;!1!==i&&-1===l.indexOf(i);){if(!isFinite(i))return i;if(!(n=e[i]))return!1;if(n.visible)return i;l.push(i),i=n.fill}return!1}function f(e){var t=e.fill,r="dataset";return!1===t?null:(isFinite(t)||(r="boundary"),a[r](e))}function c(e){return e&&!e.skip}function d(e,t,r,n,i){var a;if(n&&i){for(e.moveTo(t[0].x,t[0].y),a=1;a<n;++a)l.canvas.lineTo(e,t[a-1],t[a]);for(e.lineTo(r[i-1].x,r[i-1].y),a=i-1;a>0;--a)l.canvas.lineTo(e,r[a],r[a-1],!0)}}function p(e){return"object"!=typeof e||Array.isArray(e)||!function(e){var t;for(t in e)return!1;return!0}(e)}return module.exports={id:"filler",afterDatasetsUpdate:function(e,t){var r,n,l,a,c=(e.data.datasets||[]).length,d=t.propagate,p=[];for(n=0;n<c;++n)a=null,(l=(r=e.getDatasetMeta(n)).dataset)&&l._model&&l instanceof i.Line&&(a={visible:e.isDatasetVisible(n),fill:o(l,n,c),chart:e,el:l}),r.$filler=a,p.push(a);for(n=0;n<c;++n)(a=p[n])&&(a.fill=u(p,n,d),a.boundary=s(a),a.mapper=f(a))},beforeDatasetDraw:function(e,t){var r=t.meta.$filler;if(r){var i=e.ctx,a=r.el,o=a._view,s=a._children||[],u=r.mapper,f=o.backgroundColor||n.global.defaultColor;u&&f&&s.length&&(l.canvas.clipArea(i,e.chartArea),function(e,t,r,n,i,l){var a,o,s,u,f,p,v,g=t.length,h=n.spanGaps,b=[],x=[],y=0,m=0;for(e.beginPath(),a=0,o=g+!!l;a<o;++a)f=r(u=t[s=a%g]._view,s,n),p=c(u),v=c(f),p&&v?(y=b.push(u),m=x.push(f)):y&&m&&(h?(p&&b.push(u),v&&x.push(f)):(d(e,b,x,y,m),y=m=0,b=[],x=[]));d(e,b,x,y,m),e.closePath(),e.fillStyle=i,e.fill()}(i,s,u,o,f,a._loop),l.canvas.unclipArea(i))}}},p(module.exports)?module.exports:p(exports)?exports:void 0});
//# sourceMappingURL=../sourcemaps/plugins/plugin.filler.js.map
