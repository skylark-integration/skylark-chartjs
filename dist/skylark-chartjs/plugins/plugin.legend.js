/**
 * skylark-chartjs - A version of chartjs that ported to running on skylarkjs
 * @author Hudaokeji, Inc.
 * @version v0.9.2
 * @link https://github.com/skylarkui/skylark-chartjs/
 * @license MIT
 */
define(["../core/core.defaults","../core/core.element","../helpers/index","../core/core.layouts"],function(e,t,i,n){"use strict";var o={},a={exports:{}},l=e,r=t,d=i,s=n,h=d.noop,f=d.valueOrDefault;function p(e,t){return e.usePointStyle&&e.boxWidth>t?t:e.boxWidth}l._set("global",{legend:{display:!0,position:"top",fullWidth:!0,reverse:!1,weight:1e3,onClick:function(e,t){var i=t.datasetIndex,n=this.chart,o=n.getDatasetMeta(i);o.hidden=null===o.hidden?!n.data.datasets[i].hidden:null,n.update()},onHover:null,onLeave:null,labels:{boxWidth:40,padding:10,generateLabels:function(e){var t=e.data;return d.isArray(t.datasets)?t.datasets.map(function(t,i){return{text:t.label,fillStyle:d.isArray(t.backgroundColor)?t.backgroundColor[0]:t.backgroundColor,hidden:!e.isDatasetVisible(i),lineCap:t.borderCapStyle,lineDash:t.borderDash,lineDashOffset:t.borderDashOffset,lineJoin:t.borderJoinStyle,lineWidth:t.borderWidth,strokeStyle:t.borderColor,pointStyle:t.pointStyle,datasetIndex:i}},this):[]}}},legendCallback:function(e){var t=[];t.push('<ul class="'+e.id+'-legend">');for(var i=0;i<e.data.datasets.length;i++)t.push('<li><span style="background-color:'+e.data.datasets[i].backgroundColor+'"></span>'),e.data.datasets[i].label&&t.push(e.data.datasets[i].label),t.push("</li>");return t.push("</ul>"),t.join("")}});var u=r.extend({initialize:function(e){d.extend(this,e),this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1},beforeUpdate:h,update:function(e,t,i){var n=this;return n.beforeUpdate(),n.maxWidth=e,n.maxHeight=t,n.margins=i,n.beforeSetDimensions(),n.setDimensions(),n.afterSetDimensions(),n.beforeBuildLabels(),n.buildLabels(),n.afterBuildLabels(),n.beforeFit(),n.fit(),n.afterFit(),n.afterUpdate(),n.minSize},afterUpdate:h,beforeSetDimensions:h,setDimensions:function(){var e=this;e.isHorizontal()?(e.width=e.maxWidth,e.left=0,e.right=e.width):(e.height=e.maxHeight,e.top=0,e.bottom=e.height),e.paddingLeft=0,e.paddingTop=0,e.paddingRight=0,e.paddingBottom=0,e.minSize={width:0,height:0}},afterSetDimensions:h,beforeBuildLabels:h,buildLabels:function(){var e=this,t=e.options.labels||{},i=d.callback(t.generateLabels,[e.chart],e)||[];t.filter&&(i=i.filter(function(i){return t.filter(i,e.chart.data)})),e.options.reverse&&i.reverse(),e.legendItems=i},afterBuildLabels:h,beforeFit:h,fit:function(){var e=this,t=e.options,i=t.labels,n=t.display,o=e.ctx,a=d.options._parseFont(i),l=a.size,r=e.legendHitBoxes=[],s=e.minSize,h=e.isHorizontal();if(h?(s.width=e.maxWidth,s.height=n?10:0):(s.width=n?10:0,s.height=e.maxHeight),n)if(o.font=a.string,h){var f=e.lineWidths=[0],u=0;o.textAlign="left",o.textBaseline="top",d.each(e.legendItems,function(e,t){var n=p(i,l)+l/2+o.measureText(e.text).width;(0===t||f[f.length-1]+n+i.padding>s.width)&&(u+=l+i.padding,f[f.length-(t>0?0:1)]=i.padding),r[t]={left:0,top:0,width:n,height:l},f[f.length-1]+=n+i.padding}),s.height+=u}else{var g=i.padding,c=e.columnWidths=[],b=i.padding,v=0,m=0,x=l+g;d.each(e.legendItems,function(e,t){var n=p(i,l)+l/2+o.measureText(e.text).width;t>0&&m+x>s.height-g&&(b+=v+i.padding,c.push(v),v=0,m=0),v=Math.max(v,n),m+=x,r[t]={left:0,top:0,width:n,height:l}}),b+=v,c.push(v),s.width+=b}e.width=s.width,e.height=s.height},afterFit:h,isHorizontal:function(){return"top"===this.options.position||"bottom"===this.options.position},draw:function(){var e=this,t=e.options,i=t.labels,n=l.global,o=n.defaultColor,a=n.elements.line,r=e.width,s=e.lineWidths;if(t.display){var h,u=e.ctx,g=f(i.fontColor,n.defaultFontColor),c=d.options._parseFont(i),b=c.size;u.textAlign="left",u.textBaseline="middle",u.lineWidth=.5,u.strokeStyle=g,u.fillStyle=g,u.font=c.string;var v=p(i,b),m=e.legendHitBoxes,x=e.isHorizontal();h=x?{x:e.left+(r-s[0])/2+i.padding,y:e.top+i.padding,line:0}:{x:e.left+i.padding,y:e.top+i.padding,line:0};var y=b+i.padding;d.each(e.legendItems,function(n,l){var p=u.measureText(n.text).width,g=v+b/2+p,c=h.x,S=h.y;x?l>0&&c+g+i.padding>e.left+e.minSize.width&&(S=h.y+=y,h.line++,c=h.x=e.left+(r-s[h.line])/2+i.padding):l>0&&S+y>e.top+e.minSize.height&&(c=h.x=c+e.columnWidths[h.line]+i.padding,S=h.y=e.top+i.padding,h.line++),function(e,i,n){if(!(isNaN(v)||v<=0)){u.save();var l=f(n.lineWidth,a.borderWidth);if(u.fillStyle=f(n.fillStyle,o),u.lineCap=f(n.lineCap,a.borderCapStyle),u.lineDashOffset=f(n.lineDashOffset,a.borderDashOffset),u.lineJoin=f(n.lineJoin,a.borderJoinStyle),u.lineWidth=l,u.strokeStyle=f(n.strokeStyle,o),u.setLineDash&&u.setLineDash(f(n.lineDash,a.borderDash)),t.labels&&t.labels.usePointStyle){var r=v*Math.SQRT2/2,s=e+v/2,h=i+b/2;d.canvas.drawPoint(u,n.pointStyle,r,s,h)}else 0!==l&&u.strokeRect(e,i,v,b),u.fillRect(e,i,v,b);u.restore()}}(c,S,n),m[l].left=c,m[l].top=S,function(e,t,i,n){var o=b/2,a=v+o+e,l=t+o;u.fillText(i.text,a,l),i.hidden&&(u.beginPath(),u.lineWidth=2,u.moveTo(a,l),u.lineTo(a+n,l),u.stroke())}(c,S,n,p),x?h.x+=g+i.padding:h.y+=y})}},_getLegendItemAt:function(e,t){var i,n,o,a=this;if(e>=a.left&&e<=a.right&&t>=a.top&&t<=a.bottom)for(o=a.legendHitBoxes,i=0;i<o.length;++i)if(e>=(n=o[i]).left&&e<=n.left+n.width&&t>=n.top&&t<=n.top+n.height)return a.legendItems[i];return null},handleEvent:function(e){var t,i=this,n=i.options,o="mouseup"===e.type?"click":e.type;if("mousemove"===o){if(!n.onHover&&!n.onLeave)return}else{if("click"!==o)return;if(!n.onClick)return}t=i._getLegendItemAt(e.x,e.y),"click"===o?t&&n.onClick&&n.onClick.call(i,e.native,t):(n.onLeave&&t!==i._hoveredItem&&(i._hoveredItem&&n.onLeave.call(i,e.native,i._hoveredItem),i._hoveredItem=t),n.onHover&&t&&n.onHover.call(i,e.native,t))}});function g(e,t){var i=new u({ctx:e.ctx,options:t,chart:e});s.configure(e,i,t),s.addBox(e,i),e.legend=i}function c(e){return"object"!=typeof e||Array.isArray(e)||!function(e){var t;for(t in e)return!1;return!0}(e)}return a.exports={id:"legend",_element:u,beforeInit:function(e){var t=e.options.legend;t&&g(e,t)},beforeUpdate:function(e){var t=e.options.legend,i=e.legend;t?(d.mergeIf(t,l.global.legend),i?(s.configure(e,i,t),i.options=t):g(e,t)):i&&(s.removeBox(e,i),delete e.legend)},afterEvent:function(e,t){var i=e.legend;i&&i.handleEvent(t)}},c(a.exports)?a.exports:c(o)?o:void 0});
//# sourceMappingURL=../sourcemaps/plugins/plugin.legend.js.map
